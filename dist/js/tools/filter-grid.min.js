"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}!function(t){t.fn.drzFilterGrid=function(e){var a=t(this);return a.each(function(){var a=t(this),i=a.find(".drzFilter-grid-searchInput"),r=a.find(".drzFilter-grid-bar"),n=!!e.pagination&&~~e.pagination,l=e.filters,d="drzFilter-grid-container",s="drzFilter-grid-pagination",o="drzFilter-ellipses-first",f="drzFilter-ellipses-last",c="drzFilter-grid-paginationNums",g="drzFilter-grid-pageBtnActive",u="drzFilter-grid-pageBtn",p="drzFilter-grid-paginationPrev",h="drzFilter-grid-paginationNext",v="drzFilter-grid-pageBtnDisabled",F="drzFilter-grid-empty",m="drzFilter-grid-filters",P="drzFilter-grid-checkInput",z="drzFilter-grid-filterBox",b="drzFilter-grid-filterReset",C="drzFilter-grid-filterBtn",k=(e.feed||[]).sort(function(t,e){return new Date(e.created)-new Date(t.created)}),L={paginated:!1,totalPages:0,currentPage:1,fullList:[],filteredList:!1,searchList:!1,filterElements:{$filterBox:null,$resetBtn:null,$filterBtn:null},drawGrid:function(){var i=a.find("."+d);if(i.html(""),k.length>0){t.each(k,function(a,r){var l=t(e.output(r));if(L.paginated){l.hide();var d=~~(a/n+1);l.attr("data-pagination-page",d),a===k.length-1&&(L.totalPages=d)}i.append(l),e.onRender&&e.onRender(l)}),L.paginated?(L.updatePagination(a),L.updatePaginationView({$el:a,page:1}),L.currentPage=1,a.find("."+u).eq(0).addClass(g),a.find("."+v).removeClass(v),a.find("."+p).addClass(v),1===L.totalPages&&a.find("."+h).addClass(v)):i.children().each(function(){t(this).find("[data-asset]").each(function(){var e=t(this);e.attr("src",e.attr("data-asset")).removeAttr("data-asset")})});var r=a.find("."+F);r.length&&r.remove()}k.length<1&&L.paginated&&a.find("."+s).remove(),k.length<1&&!a.find("."+F).length&&a.append(t('<span class="'+F+'">No Items Found</span>'))},resetFilter:function(e){e.preventDefault(),L.filteredList=!1,L.searchList=!1,i.val("");var a=L.$filterBox.find("."+P+":checked");a.length>0&&a.each(function(){t(this).attr("checked",!1)}),k=L.fullList,L.drawGrid()},onFilterClick:function(t){t.preventDefault(),L.$filterBox.toggle(),L.$resetBtn.toggleClass("drzFilter-grid-filterResetShow"),L.$filterBtn.toggleClass("drzFilter-grid-filterBtnOpen")},buildFilters:function(){if(l){var e=t('\n              <div class="'+z+'">\n                <a href="#" class="'+b+'">Reset</a>\n                <button class="'+C+'" name="filters">Filters</button>\n              </div>\n            ');r.append(e);var a=e.find("."+C);L.$filterBtn=a;var i=e.find("."+b);L.$resetBtn=i,a.click(L.onFilterClick),i.click(L.resetFilter);var n=t('<div class="'+m+'"></div>');L.$filterBox=n,n.insertAfter(r),t.each(l,function(e,a){var i=L.tinyId(),r=t('\n                <div class="drzFilter-grid-checkFilter">\n                  <input class="'+P+'" value="'+a+'" id="'+a+"-"+i+'" type="checkbox" />\n                  <label class="drzFilter-grid-checkLabel" for="'+a+"-"+i+'">'+a+"</label>\n                </div>\n              ");n.append(r),r.find("."+P).change(function(){var e=n.find("."+P+":checked");if(e.length>0){var a=[];e.each(function(){a.push(t(this).attr("value"))});var i=L.searchList||L.fullList;k=i.filter(function(t){return a.every(function(e){return t.categories.indexOf(e)>-1})}),L.filteredList=k}else k=L.searchList||L.fullList,L.filteredList=!1;L.drawGrid()})})}},updatePagination:function(e){var a=e.find("."+s),i=a.find("."+c);a.length?i.html(""):(a=t('\n            <div class="'+s+'">\n              <button class="'+p+'" data-page="prev"></button>\n              <div class="'+c+'"></div>\n              <button class="'+h+'" data-page="next"></button>\n            </div>'),i=a.find("."+c),a.find("."+p).click(L.clickPagination),a.find("."+h).click(L.clickPagination),e.append(a)),t.each([].concat(_toConsumableArray(Array(L.totalPages).keys())),function(e){var a=e+1,r=t('<button class="'+u+'" data-page="'+a+'">'+a+"</button>");if(L.totalPages>=10){if(2===a||a===L.totalPages){var n=2===a?"first":"last",l=t('<span class="drzFilter-grid-ellipses drzFilter-ellipses-'+n+'">...</span>');i.append(l),"first"===n&&l.hide()}a>=7&&a<L.totalPages&&r.hide()}r.click(L.clickPagination),i.append(r)})},clickPagination:function(e){e.preventDefault();var i=t(e.currentTarget),r=i,n=i.attr("data-page"),l=i.parent().find("."+g),d=void 0;if("next"===n){var c=1+~~L.currentPage;if(c>L.totalPages)return;d=c,l.removeClass(g),(r=i.parent().find('[data-page="'+d+'"]')).addClass(g)}if("prev"===n){var u=~~L.currentPage-1;if(u<1)return;d=u,l.removeClass(g),(r=i.parent().find('[data-page="'+d+'"]')).addClass(g)}"prev"!==n&&"next"!==n&&(l.removeClass(g),i.addClass(g),d=~~n),L.currentPage=d;var F=a.find("."+p),m=a.find("."+h);if(1==~~d?F.addClass(v):F.removeClass(v),~~d===L.totalPages?m.addClass(v):m.removeClass(v),L.updatePaginationView({$el:a,page:d}),L.totalPages>=10){var P=a.find("."+s),z=P.find("."+o),b=P.find("."+f);P.find("[data-page]:not(:last-child):not(:first-child)").hide();var C=L.totalPages-5;d<=6&&(L.setVisibleRange({start:2,end:6,$paginationContaner:P}),b.show(),z.hide()),d>6&&d<C&&(L.setVisibleRange({start:d-2,end:d+2,$paginationContaner:P}),z.show(),b.show(),r.show()),d>=C&&(L.setVisibleRange({start:C,end:L.totalPages-1,$paginationContaner:P}),b.hide(),z.show())}},setVisibleRange:function(t){for(var e=t.start;e<=t.end;e++){t.$paginationContaner.find('[data-page="'+e+'"]').show()}},updatePaginationView:function(e){e.$el.find("[data-pagination-page]").hide();var a=e.$el.find('[data-pagination-page="'+e.page+'"]');a.show(),a.each(function(){var e=t(this).find("[data-asset]");e.length&&(e.attr("src",e.attr("data-asset")),e.removeAttr("data-asset"))})},searchTime:null,onSearch:function(t){clearTimeout(L.searchTime),L.searchTime=setTimeout(function(){var a=new RegExp(t.target.value,"gi"),i=e.searchKeys||[],r=L.filteredList||L.fullList;""===t.target.value?(L.searchList=!1,k=r):(k=r.filter(function(t){for(var e=0;e<i.length;e++){if(t[i[e]].match(a))return t}return!1}),L.searchList=k),L.drawGrid()},250)},tinyId:function(){return""+Math.floor(65536*(1+Math.random())).toString(16).substring(1)}};L.fullList=k,L.paginated="boolean"!=typeof n,i.on("input",L.onSearch),L.drawGrid(),L.buildFilters(),t.fn.drzFilterGrid.destroy=function(t){L.totalPages=0,L.currentPage=1,L.fullList=[],L.filteredList=!1,L.searchList=!1,L.filterElements={$filterBox:null,$resetBtn:null,$filterBtn:null};var e=t.find(".drzFilter-grid-searchInput");e.val(""),e.off("input"),t.find("."+d).html("");var a=t.find("."+C),i=t.find("."+b);a.off("click"),i.off("click"),t.find("."+z).remove(),t.find("."+m).remove(),t.find("."+s).remove();var r=t.find("."+F);r.length&&r.remove()}}),a}}(jQuery);