"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}!function(t){t.fn.drzFilterGrid=function(e){var i=t(this);return i.each(function(){var i=t(this),r=i.find(".drzFilter-grid-searchInput"),a=i.find(".drzFilter-grid-bar"),n=!!e.pagination&&~~e.pagination,l=e.filters,d="drzFilter-grid-pagination",s="drzFilter-ellipses-first",f="drzFilter-ellipses-last",o="drzFilter-grid-paginationNums",c="drzFilter-grid-pageBtnActive",g="drzFilter-grid-pageBtn",u="drzFilter-grid-paginationPrev",p="drzFilter-grid-paginationNext",h="drzFilter-grid-pageBtnDisabled",v="drzFilter-grid-empty",F="drzFilter-grid-checkInput",z=(e.feed||[]).sort(function(t,e){return new Date(e.created)-new Date(t.created)}),m={paginated:!1,totalPages:0,currentPage:1,fullList:[],filteredList:!1,searchList:!1,filterElements:{$filterBox:null,$resetBtn:null,$filterBtn:null},drawGrid:function(){var r=i.find(".drzFilter-grid-container");if(r.html(""),z.length>0){t.each(z,function(i,a){var l=t(e.output(a));if(m.paginated){l.hide();var d=~~(i/n+1);l.attr("data-pagination-page",d),i===z.length-1&&(m.totalPages=d)}r.append(l),e.onRender&&e.onRender(l)}),m.paginated?(m.updatePagination(i),m.updatePaginationView({$el:i,page:1}),m.currentPage=1,i.find("."+g).eq(0).addClass(c),i.find("."+h).removeClass(h),i.find("."+u).addClass(h),1===m.totalPages&&i.find("."+p).addClass(h)):r.children().each(function(){t(this).find("[data-asset]").each(function(){var e=t(this);e.attr("src",e.attr("data-asset")).removeAttr("data-asset")})});var a=i.find("."+v);a.length&&a.remove()}z.length<1&&m.paginated&&i.find("."+d).remove(),z.length<1&&!i.find("."+v).length&&i.append(t('<span class="'+v+'">No Items Found</span>'))},resetFilter:function(e){e.preventDefault(),m.filteredList=!1,m.searchList=!1,r.val("");var i=m.$filterBox.find("."+F+":checked");i.length>0&&i.each(function(){t(this).attr("checked",!1)}),z=m.fullList,m.drawGrid()},onFilterClick:function(t){t.preventDefault(),m.$filterBox.toggle(),m.$resetBtn.toggleClass("drzFilter-grid-filterResetShow"),m.$filterBtn.toggleClass("drzFilter-grid-filterBtnOpen")},buildFilters:function(){if(l){var e=t('\n              <div class="drzFilter-grid-filterBox">\n                <a href="#" class="drzFilter-grid-filterReset">Reset</a>\n                <button class="drzFilter-grid-filterBtn" name="filters">Filters</button>\n              </div>\n            ');a.append(e);var i=e.find(".drzFilter-grid-filterBtn");m.$filterBtn=i;var r=e.find(".drzFilter-grid-filterReset");m.$resetBtn=r,i.click(m.onFilterClick),r.click(m.resetFilter);var n=t('<div class="drzFilter-grid-filters"></div>');m.$filterBox=n,n.insertAfter(a),t.each(l,function(e,i){var r=m.tinyId(),a=t('\n                <div class="drzFilter-grid-checkFilter">\n                  <input class="'+F+'" value="'+i+'" id="'+i+"-"+r+'" type="checkbox" />\n                  <label class="drzFilter-grid-checkLabel" for="'+i+"-"+r+'">'+i+"</label>\n                </div>\n              ");n.append(a),a.find("."+F).change(function(){var e=n.find("."+F+":checked");if(e.length>0){var i=[];e.each(function(){i.push(t(this).attr("value"))});var r=m.searchList||m.fullList;z=r.filter(function(t){return i.every(function(e){return t.categories.indexOf(e)>-1})}),m.filteredList=z}else z=m.searchList||m.fullList,m.filteredList=!1;m.drawGrid()})})}},updatePagination:function(e){var i=e.find("."+d),r=i.find("."+o);i.length?r.html(""):(i=t('\n            <div class="'+d+'">\n              <button class="'+u+'" data-page="prev"></button>\n              <div class="'+o+'"></div>\n              <button class="'+p+'" data-page="next"></button>\n            </div>'),r=i.find("."+o),i.find("."+u).click(m.clickPagination),i.find("."+p).click(m.clickPagination),e.append(i)),t.each([].concat(_toConsumableArray(Array(m.totalPages).keys())),function(e){var i=e+1,a=t('<button class="'+g+'" data-page="'+i+'">'+i+"</button>");if(m.totalPages>=10){if(2===i||i===m.totalPages){var n=2===i?"first":"last",l=t('<span class="drzFilter-grid-ellipses drzFilter-ellipses-'+n+'">...</span>');r.append(l),"first"===n&&l.hide()}i>=7&&i<m.totalPages&&a.hide()}a.click(m.clickPagination),r.append(a)})},clickPagination:function(e){e.preventDefault();var r=t(e.currentTarget),a=r,n=r.attr("data-page"),l=r.parent().find("."+c),o=void 0;if("next"===n){var g=1+~~m.currentPage;if(g>m.totalPages)return;o=g,l.removeClass(c),(a=r.parent().find('[data-page="'+o+'"]')).addClass(c)}if("prev"===n){var v=~~m.currentPage-1;if(v<1)return;o=v,l.removeClass(c),(a=r.parent().find('[data-page="'+o+'"]')).addClass(c)}"prev"!==n&&"next"!==n&&(l.removeClass(c),r.addClass(c),o=~~n),m.currentPage=o;var F=i.find("."+u),z=i.find("."+p);if(1==~~o?F.addClass(h):F.removeClass(h),~~o===m.totalPages?z.addClass(h):z.removeClass(h),m.updatePaginationView({$el:i,page:o}),m.totalPages>=10){var P=i.find("."+d),b=P.find("."+s),C=P.find("."+f);P.find("[data-page]:not(:last-child):not(:first-child)").hide();var B=m.totalPages-5;o<=6&&(m.setVisibleRange({start:2,end:6,$paginationContaner:P}),C.show(),b.hide()),o>6&&o<B&&(m.setVisibleRange({start:o-2,end:o+2,$paginationContaner:P}),b.show(),C.show(),a.show()),o>=B&&(m.setVisibleRange({start:B,end:m.totalPages-1,$paginationContaner:P}),C.hide(),b.show())}},setVisibleRange:function(t){for(var e=t.start;e<=t.end;e++){t.$paginationContaner.find('[data-page="'+e+'"]').show()}},updatePaginationView:function(e){e.$el.find("[data-pagination-page]").hide();var i=e.$el.find('[data-pagination-page="'+e.page+'"]');i.show(),i.each(function(){var e=t(this).find("[data-asset]");e.length&&(e.attr("src",e.attr("data-asset")),e.removeAttr("data-asset"))})},searchTime:null,onSearch:function(t){clearTimeout(m.searchTime),m.searchTime=setTimeout(function(){var i=new RegExp(t.target.value,"gi"),r=e.searchKeys||[],a=m.filteredList||m.fullList;""===t.target.value?(m.searchList=!1,z=a):(z=a.filter(function(t){for(var e=0;e<r.length;e++){if(t[r[e]].match(i))return t}return!1}),m.searchList=z),m.drawGrid()},250)},tinyId:function(){return""+Math.floor(65536*(1+Math.random())).toString(16).substring(1)}};m.fullList=z,m.paginated="boolean"!=typeof n,r.on("input",m.onSearch),m.drawGrid(),m.buildFilters(),t.fn.drzFilterGrid.destroy=function(t){m.totalPages=0,m.currentPage=1,m.fullList=[],m.filteredList=!1,m.searchList=!1,m.filterElements={$filterBox:null,$resetBtn:null,$filterBtn:null};var e=t.find(".drzFilter-grid-searchInput");e.val(""),e.off("input"),t.find(".drzFilter-grid-container").html("");var i=t.find(".drzFilter-grid-filterBtn"),r=t.find(".drzFilter-grid-filterReset");i.off("click"),r.off("click"),t.find(".drzFilter-grid-filters").remove(),t.find(".drzFilter-grid-filterBox").remove(),t.find("."+d).remove();var a=t.find("."+v);a.length&&a.remove()}}),i}}(jQuery);