"use strict";var _typeof2=require("babel-runtime/helpers/typeof"),_typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}!function(e){e.fn.drzMap=function(){return e(this).each(function(){var t=e(this),o=t.find(".drzMap-container"),s=t.find(".drzMap-zoomIn").get(0),i=t.find(".drzMap-zoomOut").get(0),r=t.find(".drzMap-container").get(0),n=t.find(".drzMap-address"),a=e(window),l=navigator.userAgent.toLowerCase().indexOf("trident")>-1,p={getHex:function(e){var t=e;if(/^#[0-9A-F]{6}$/i.test(t))return t;function o(e){return("0"+parseInt(e,10).toString(16)).slice(-2)}return"#"+o((t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/)||e.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d+)\)$/))[1])+o(t[2])+o(t[3])},CustomZoomControl:function(e,t,o){if(void 0!==s&&void 0!==i){s.style.backgroundColor=o,i.style.backgroundColor=o;var r=s,n=i;e.appendChild(r),e.appendChild(n),e.classList.add("drzMap-zoomContainer"),google.maps.event.addDomListener(r,"click",function(){t.setZoom(t.getZoom()+1)}),google.maps.event.addDomListener(n,"click",function(){t.setZoom(t.getZoom()-1)})}},renderMap:function(t){var o=t,s={baseColor:n.css("background-color"),markers:[]};"undefined"!==(void 0===o?"undefined":(0,_typeof3.default)(o))&&!1!==o?("string"==typeof o&&(o=JSON.parse(o)),o=e.extend(!0,{},s,o)):o=s,o.useBg&&(o.baseColor=p.getHex(n.css("background-color")));var i=p.getHex(o.baseColor),a=[{elementType:"labels",stylers:[{saturation:-20}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"poi.government",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"poi.sports_complex",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"poi.attraction",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"poi.business",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"transit",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"transit.station",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"landscape",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"road",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]},{featureType:"water",elementType:"geometry",stylers:[{hue:i},{visibility:"on"},{lightness:5},{saturation:-20}]}],u=[],y={zoom:15,panControl:!1,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,styles:a};o.markers.length<=1&&(y.center=new google.maps.LatLng(o.markers[0].lat,o.markers[0].lng));var d=new google.maps.Map(r,y);drzzle.googleMaps.push(d);for(var g=new google.maps.LatLngBounds,m=function(e){var t=o.markers[e],s='<div class="drzMap-markerTip">\n              <span class="drzMap-markerTitle">'+(t.title||"")+'</span>\n              <span class="drzMap-markerAddr">'+(t.address||"")+"</span>\n              </div>",i=new google.maps.InfoWindow({content:s,maxWidth:200}),r=new google.maps.LatLng(t.lat,t.lng),n=l?"https://s3-us-west-1.amazonaws.com/drz-assets/mock-images/icons/maps-default-pin.png":t.markerImg;g.extend(r);var a=new google.maps.Marker({position:r,map:d,visible:!0,icon:n});a.addListener("click",function(){i.open(d,a)}),u.push(a)},f=0;f<o.markers.length;f++)m(f);u.length>1&&(d.fitBounds(g),d.panToBounds(g)),google.maps.event.addListenerOnce(d,"idle",function(){var e=document.createElement("div");new p.CustomZoomControl(e,d,o.baseColor);d.controls[google.maps.ControlPosition.LEFT_TOP].push(e)})}},u=void 0;if(o.length){var y=t.attr("data-google-map"),d=void 0,g=!0,m=void 0;u=function(){g&&JSON.parse(y).useBg&&(g=!1,m=n.css("background-color")),clearTimeout(d),d=setTimeout(function(){m!==n.css("background-color")&&p.renderMap(y),g=!0},250)},a.resize(u),p.renderMap(y)}e.fn.drzMap.destroy=function(){a.off("resize",u)}}),this}}(jQuery);